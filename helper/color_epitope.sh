#!/bin/bash

# bash ~/work/scripts/helper/color_epitope.sh 

# 35O22 (4) /home/cagostino/work/workspace/gp120-gp41_interface/35O22/top50/movie
substrings=("ENVTEE" "NGTGPCP" "GST" "RNLSEIWDNMTWLQWDK") # one design has multiple GST
# sele (4TVP_V3g_topo02_1761_seq07_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 31+32+33+34+35+36+149+150+151+152+153+154+155+6+7+8+88+89+90+91+92+93+94+95+96+97+98+99+100+101+102+103+104) or (4TVP_V3g_topo02_1761_seq10_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 31+32+33+34+35+36+149+150+151+152+153+154+155+6+7+8+88+89+90+91+92+93+94+95+96+97+98+99+100+101+102+103+104) or (4TVP_V3g_topo07_91_seq03_unrelaxed_rank_002_alphafold2_ptm_model_4_seed_000-aligned and resi 11+12+13+14+15+16+149+150+151+152+153+154+155+72+73+74+75+76+77+78+79+80+81+82+83+84+85+86+87+88) or (4TVP_V3g_topo11_1334_seq07_unrelaxed_rank_002_alphafold2_ptm_model_3_seed_000-aligned and resi 44+45+46+47+48+49+93+94+95+96+97+98+99+15+16+17+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+160) or (4TVP_V3g_topo11_1334_seq09_unrelaxed_rank_001_alphafold2_ptm_model_3_seed_000-aligned and resi 44+45+46+47+48+49+93+94+95+96+97+98+99+15+16+17+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+160) or (4TVP_V3g_topo11_1617_seq06_unrelaxed_rank_001_alphafold2_ptm_model_3_seed_000-aligned and resi 42+43+44+45+46+47+86+87+88+89+90+91+92+18+19+20+135+136+137+138+139+140+141+142+143+144+145+146+147+148+149+150+151) or (4TVP_V3g_topo11_1936_seq06_unrelaxed_rank_001_alphafold2_ptm_model_3_seed_000-aligned and resi 46+47+48+49+50+51+88+89+90+91+92+93+94+23+24+25+150+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166) or (4TVP_V3g_topo21_557_seq09_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 85+86+87+88+89+90+66+67+68+69+70+71+72+103+104+105+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34) or (4TVP_V3g_topo23_635_seq04_unrelaxed_rank_001_alphafold2_ptm_model_3_seed_000-aligned and resi 11+12+13+14+15+16+98+99+100+101+102+103+104+55+56+57+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157) or (4TVP_V3g_topo23_635_seq09_unrelaxed_rank_001_alphafold2_ptm_model_3_seed_000-aligned and resi 11+12+13+14+15+16+98+99+100+101+102+103+104+55+56+57+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157)

# 35O22 (5) /home/cagostino/work/workspace/gp120-gp41_interface/35O22/top50/movie
substrings=("GST" "NKSLDRIWNNMTWMEWER" "ENVTEH" "PCKNVS")
# sele (5FYK_V3g_topo01_1265_seq03_unrelaxed_rank_001_alphafold2_ptm_model_3_seed_000-aligned and resi 170+171+172+24+25+26+27+28+29+30+31+32+33+34+35+36+37+38+39+40+41+95+96+97+98+99+100+126+127+128+129+130+131) or (5FYK_V3g_topo01_1265_seq09_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 170+171+172+24+25+26+27+28+29+30+31+32+33+34+35+36+37+38+39+40+41+95+96+97+98+99+100+126+127+128+129+130+131) or (5FYK_V3g_topo01_363_seq03_unrelaxed_rank_002_alphafold2_ptm_model_4_seed_000-aligned and resi 142+143+144+24+25+26+27+28+29+30+31+32+33+34+35+36+37+38+39+40+41+81+82+83+84+85+86+92+93+94+95+96+97) or (5FYK_V3g_topo01_762_seq04_unrelaxed_rank_001_alphafold2_ptm_model_4_seed_000-aligned and resi 158+159+160+26+27+28+29+30+31+32+33+34+35+36+37+38+39+40+41+42+43+87+88+89+90+91+92+100+101+102+103+104+105) or (5FYK_V3g_topo05_1082_seq04_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 133+134+135+76+77+78+79+80+81+82+83+84+85+86+87+88+89+90+91+92+93+26+27+28+29+30+31+6+7+8+9+10+11) or (5FYK_V3g_topo05_1620_seq07_unrelaxed_rank_001_alphafold2_ptm_model_3_seed_000-aligned and resi 166+167+168+100+101+102+103+104+105+106+107+108+109+110+111+112+113+114+115+116+117+45+46+47+48+49+50+25+26+27+28+29+30) or (5FYK_V3g_topo05_349_seq03_unrelaxed_rank_002_alphafold2_ptm_model_4_seed_000-aligned and resi 199+200+201+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+169+170+171+91+92+93+94+95+96+31+32+33+34+35+36) or (5FYK_V3g_topo06_1043_seq02_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 20+21+22+65+66+67+68+69+70+71+72+73+74+75+76+77+78+79+80+81+82+138+139+140+141+142+143+191+192+193+194+195+196) or (5FYK_V3g_topo07_1219_seq05_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 131+132+133+45+46+47+48+49+50+51+52+53+54+55+56+57+58+59+60+61+62+8+9+10+11+12+13+102+103+104+105+106+107) or (5FYK_V3g_topo07_1596_seq08_unrelaxed_rank_002_alphafold2_ptm_model_4_seed_000-aligned and resi 134+135+136+57+58+59+60+61+62+63+64+65+66+67+68+69+70+71+72+73+74+20+21+22+23+24+25+114+115+116+117+118+119) or (5FYK_V3g_topo07_1877_seq08_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 167+168+169+61+62+63+64+65+66+67+68+69+70+71+72+73+74+75+76+77+78+7+8+9+10+11+12+139+140+141+142+143+144) or (5FYK_V3g_topo07_842_seq01_unrelaxed_rank_002_alphafold2_ptm_model_4_seed_000-aligned and resi 145+146+147+50+51+52+53+54+55+56+57+58+59+60+61+62+63+64+65+66+67+6+7+8+9+10+11+87+88+89+90+91+92) or (5FYK_V3g_topo09_1536_seq02_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 37+38+39+84+85+86+87+88+89+90+91+92+93+94+95+96+97+98+99+100+101+150+151+152+153+154+155+11+12+13+14+15+16) or (5FYK_V3g_topo09_1536_seq04_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 37+38+39+84+85+86+87+88+89+90+91+92+93+94+95+96+97+98+99+100+101+150+151+152+153+154+155+11+12+13+14+15+16) or (5FYK_V3g_topo09_1661_seq08_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 60+61+62+101+102+103+104+105+106+107+108+109+110+111+112+113+114+115+116+117+118+161+162+163+164+165+166+5+6+7+8+9+10) or (5FYK_V3g_topo09_1661_seq10_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 60+61+62+101+102+103+104+105+106+107+108+109+110+111+112+113+114+115+116+117+118+161+162+163+164+165+166+5+6+7+8+9+10) or (5FYK_V3g_topo10_1837_seq05_unrelaxed_rank_001_alphafold2_ptm_model_4_seed_000-aligned and resi 84+85+86+117+118+119+120+121+122+123+124+125+126+127+128+129+130+131+132+133+134+39+40+41+42+43+44+18+19+20+21+22+23) or (5FYK_V3g_topo10_304_seq02_unrelaxed_rank_001_alphafold2_ptm_model_3_seed_000-aligned and resi 91+92+93+133+134+135+136+137+138+139+140+141+142+143+144+145+146+147+148+149+150+49+50+51+52+53+54+29+30+31+32+33+34) or (5FYK_V3g_topo10_345_seq07_unrelaxed_rank_001_alphafold2_ptm_model_3_seed_000-aligned and resi 78+79+80+122+123+124+125+126+127+128+129+130+131+132+133+134+135+136+137+138+139+46+47+48+49+50+51+21+22+23+24+25+26) or (5FYK_V3g_topo10_593_seq09_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 93+94+95+126+127+128+129+130+131+132+133+134+135+136+137+138+139+140+141+142+143+42+43+44+45+46+47+24+25+26+27+28+29) or (5FYK_V3g_topo10_649_seq04_unrelaxed_rank_001_alphafold2_ptm_model_4_seed_000-aligned and resi 92+93+94+136+137+138+139+140+141+142+143+144+145+146+147+148+149+150+151+152+153+54+55+56+57+58+59+17+18+19+20+21+22) or (5FYK_V3g_topo10_927_seq07_unrelaxed_rank_001_alphafold2_ptm_model_3_seed_000-aligned and resi 83+84+85+117+118+119+120+121+122+123+124+125+126+127+128+129+130+131+132+133+134+43+44+45+46+47+48+20+21+22+23+24+25) or (5FYK_V3g_topo12_104_seq05_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 38+39+40+129+130+131+132+133+134+135+136+137+138+139+140+141+142+143+144+145+146+73+74+75+76+77+78+7+8+9+10+11+12) or (5FYK_V3g_topo12_104_seq07_unrelaxed_rank_001_alphafold2_ptm_model_3_seed_000-aligned and resi 38+39+40+129+130+131+132+133+134+135+136+137+138+139+140+141+142+143+144+145+146+73+74+75+76+77+78+7+8+9+10+11+12) or (5FYK_V3g_topo12_915_seq07_unrelaxed_rank_001_alphafold2_ptm_model_4_seed_000-aligned and resi 88+89+90+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+116+117+118+119+120+121+29+30+31+32+33+34) or (5FYK_V3g_topo13_1689_seq08_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 73+74+75+99+100+101+102+103+104+105+106+107+108+109+110+111+112+113+114+115+116+13+14+15+16+17+18+175+176+177+178+179+180) or (5FYK_V3g_topo13_744_seq02_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 68+69+70+115+116+117+118+119+120+121+122+123+124+125+126+127+128+129+130+131+132+26+27+28+29+30+31+187+188+189+190+191+192) or (5FYK_V3g_topo14_1215_seq07_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 134+135+136+75+76+77+78+79+80+81+82+83+84+85+86+87+88+89+90+91+92+160+161+162+163+164+165+31+32+33+34+35+36) or (5FYK_V3g_topo15_1919_seq07_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 154+155+156+86+87+88+89+90+91+92+93+94+95+96+97+98+99+100+101+102+103+10+11+12+13+14+15+21+22+23+24+25+26) or (5FYK_V3g_topo15_1923_seq05_unrelaxed_rank_001_alphafold2_ptm_model_4_seed_000-aligned and resi 154+155+156+93+94+95+96+97+98+99+100+101+102+103+104+105+106+107+108+109+110+8+9+10+11+12+13+51+52+53+54+55+56) or (5FYK_V3g_topo15_1923_seq08_unrelaxed_rank_001_alphafold2_ptm_model_4_seed_000-aligned and resi 154+155+156+93+94+95+96+97+98+99+100+101+102+103+104+105+106+107+108+109+110+8+9+10+11+12+13+51+52+53+54+55+56) or (5FYK_V3g_topo18_1282_seq04_unrelaxed_rank_002_alphafold2_ptm_model_3_seed_000-aligned and resi 121+122+123+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+7+8+9+10+11+12+72+73+74+75+76+77) or (5FYK_V3g_topo18_1282_seq10_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 121+122+123+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+7+8+9+10+11+12+72+73+74+75+76+77) or (5FYK_V3g_topo18_1343_seq04_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 90+91+92+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+9+10+11+12+13+14+56+57+58+59+60+61) or (5FYK_V3g_topo18_1533_seq03_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 77+78+79+131+132+133+134+135+136+137+138+139+140+141+142+143+144+145+146+147+148+9+10+11+12+13+14+48+49+50+51+52+53) or (5FYK_V3g_topo18_320_seq10_unrelaxed_rank_001_alphafold2_ptm_model_4_seed_000-aligned and resi 100+101+102+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+7+8+9+10+11+12+54+55+56+57+58+59) or (5FYK_V3g_topo18_462_seq09_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 116+117+118+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+7+8+9+10+11+12+50+51+52+53+54+55) or (5FYK_V3g_topo18_622_seq09_unrelaxed_rank_002_alphafold2_ptm_model_3_seed_000-aligned and resi 89+90+91+119+120+121+122+123+124+125+126+127+128+129+130+131+132+133+134+135+136+23+24+25+26+27+28+43+44+45+46+47+48) or (5FYK_V3g_topo18_816_seq04_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 82+83+84+116+117+118+119+120+121+122+123+124+125+126+127+128+129+130+131+132+133+27+28+29+30+31+32+39+40+41+42+43+44) or (5FYK_V3g_topo18_816_seq09_unrelaxed_rank_001_alphafold2_ptm_model_5_seed_000-aligned and resi 82+83+84+116+117+118+119+120+121+122+123+124+125+126+127+128+129+130+131+132+133+27+28+29+30+31+32+39+40+41+42+43+44)

# prefusion /home/cagostino/work/workspace/prefusion_gp41/order/colabfold/a3ms/final/movie
substrings=("NLWVTVYYGVPVWK" "KIEPLGVAPTRCKRR" "LGFLGAAGSTMGAASMTLTVQARNLLS" "GIKQLQARVLAVEHYLRDQQLLGIWGCSGKLICCTNVPWNSSWSNRNLSEIWDNMTWLQWDKEISNYTQIIYGLLEESQNQQEKNEQDLLALD")
# sele (interprot_topo01_seq01_N6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_1_seed_000-aligned and resi 114+115+116+117+118+119+120+121+122+123+124+125+126+127+250+251+252+253+254+255+256+257+258+259+260+261+262+263+264+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+36+37+38+39+40+41+42+43+44+45+46+47+48+49+50+51+52+53+54+55+56+57+58+59+60+61+62+63+64+65+66+67+68+69+70+71+72+73+74+75+76+77+78+79+80+81+82+83+84+85+86+87+88+89+90+91+92+93+94+95+96+97+98+99+100+101) or (interprot_topo01_seq02_N6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_2_seed_000-aligned and resi 117+118+119+120+121+122+123+124+125+126+127+128+129+130+217+218+219+220+221+222+223+224+225+226+227+228+229+230+231+159+160+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+36+37+38+39+40+41+42+43+44+45+46+47+48+49+50+51+52+53+54+55+56+57+58+59+60+61+62+63+64+65+66+67+68+69+70+71+72+73+74+75+76+77+78+79+80+81+82+83+84+85+86+87+88+89+90+91+92+93+94+95+96+97+98+99+100+101) or (interprot_topo01_seq03_N6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_2_seed_000-aligned and resi 122+123+124+125+126+127+128+129+130+131+132+133+134+135+265+266+267+268+269+270+271+272+273+274+275+276+277+278+279+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+36+37+38+39+40+41+42+43+44+45+46+47+48+49+50+51+52+53+54+55+56+57+58+59+60+61+62+63+64+65+66+67+68+69+70+71+72+73+74+75+76+77+78+79+80+81+82+83+84+85+86+87+88+89+90+91+92+93+94+95+96+97+98+99+100+101) or (interprot_topo01_seq04_N6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_2_seed_000-aligned and resi 122+123+124+125+126+127+128+129+130+131+132+133+134+135+265+266+267+268+269+270+271+272+273+274+275+276+277+278+279+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+36+37+38+39+40+41+42+43+44+45+46+47+48+49+50+51+52+53+54+55+56+57+58+59+60+61+62+63+64+65+66+67+68+69+70+71+72+73+74+75+76+77+78+79+80+81+82+83+84+85+86+87+88+89+90+91+92+93+94+95+96+97+98+99+100+101) or (interprot_topo01_seq05_N6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_2_seed_000-aligned and resi 122+123+124+125+126+127+128+129+130+131+132+133+134+135+265+266+267+268+269+270+271+272+273+274+275+276+277+278+279+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+36+37+38+39+40+41+42+43+44+45+46+47+48+49+50+51+52+53+54+55+56+57+58+59+60+61+62+63+64+65+66+67+68+69+70+71+72+73+74+75+76+77+78+79+80+81+82+83+84+85+86+87+88+89+90+91+92+93+94+95+96+97+98+99+100+101) or (intraprot_topo01_seq01_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_4_seed_000-aligned and resi 1+2+3+4+5+6+7+8+9+10+11+12+13+14+32+33+34+35+36+37+38+39+40+41+42+43+44+45+46+67+68+69+70+71+72+73+74+75+76+77+78+79+80+81+82+83+84+85+86+87+88+89+90+91+92+93+119+120+121+122+123+124+125+126+127+128+129+130+131+132+133+134+135+136+137+138+139+140+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211) or (intraprot_topo01_seq02_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_3_seed_000-aligned and resi 1+2+3+4+5+6+7+8+9+10+11+12+13+14+75+76+77+78+79+80+81+82+83+84+85+86+87+88+89+130+131+132+133+134+135+136+137+138+139+140+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+212+213+214+215+216+217+218+219+220+221+222+223+224+225+226+227+228+229+230+231+232+233+234+235+236+237+238+239+240+241+242+243+244+245+246+247+248+249+250+251+252+253+254+255+256+257+258+259+260+261+262+263) or (intraprot_topo01_seq03_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_4_seed_000-aligned and resi 1+2+3+4+5+6+7+8+9+10+11+12+13+14+32+33+34+35+36+37+38+39+40+41+42+43+44+45+46+87+88+89+90+91+92+93+94+95+96+97+98+99+100+101+102+103+104+105+106+107+108+109+110+111+112+113+139+140+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+212+213+214+215+216+217+218+219+220+221+222+223+224+225+226+227+228+229+230+231) or (intraprot_topo01_seq04_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_4_seed_000-aligned and resi 1+2+3+4+5+6+7+8+9+10+11+12+13+14+75+76+77+78+79+80+81+82+83+84+85+86+87+88+89+110+111+112+113+114+115+116+117+118+119+120+121+122+123+124+125+126+127+128+129+130+131+132+133+134+135+136+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+212+213+214+215+216+217+218+219+220+221+222+223+224+225+226+227+228+229+230+231+232+233+234+235+236+237+238+239+240+241+242+243) or (intraprot_topo02_seq01_FP_C6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_2_seed_000-aligned and resi 120+121+122+123+124+125+126+127+128+129+130+131+132+133+95+96+97+98+99+100+101+102+103+104+105+106+107+108+109+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+212+213+214+215+216+217+218+219+220+221+222+223+224+225+226+227+228+229+230+231+232+233+234+235+236+237+238+239+240+241+242+243+244+245+246+247+248+249+250+251+252+253+254+255+256+257+258+259+260+261+262+263+264+265+266+267) or (intraprot_topo02_seq02_FP_C6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_1_seed_000-aligned and resi 68+69+70+71+72+73+74+75+76+77+78+79+80+81+46+47+48+49+50+51+52+53+54+55+56+57+58+59+60+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+123+124+125+126+127+128+129+130+131+132+133+134+135+136+137+138+139+140+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+212+213+214+215) or (intraprot_topo02_seq03_FP_C6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_1_seed_000-aligned and resi 79+80+81+82+83+84+85+86+87+88+89+90+91+92+59+60+61+62+63+64+65+66+67+68+69+70+71+72+73+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+105+106+107+108+109+110+111+112+113+114+115+116+117+118+119+120+121+122+123+124+125+126+127+128+129+130+131+132+133+134+135+136+137+138+139+140+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197) or (intraprot_topo02_seq04_FP_C6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_1_seed_000-aligned and resi 116+117+118+119+120+121+122+123+124+125+126+127+128+129+95+96+97+98+99+100+101+102+103+104+105+106+107+108+109+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+212+213+214+215+216+217+218+219+220+221+222+223+224+225+226+227+228+229+230+231+232+233+234+235+236+237+238+239+240+241+242+243+244+245+246+247+248+249+250+251+252+253+254) or (intraprot_topo02_seq05_FP_C6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_4_seed_000-aligned and resi 75+76+77+78+79+80+81+82+83+84+85+86+87+88+54+55+56+57+58+59+60+61+62+63+64+65+66+67+68+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+115+116+117+118+119+120+121+122+123+124+125+126+127+128+129+130+131+132+133+134+135+136+137+138+139+140+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207) or (intraprot_topo02_seq06_FP_C6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_1_seed_000-aligned and resi 92+93+94+95+96+97+98+99+100+101+102+103+104+105+67+68+69+70+71+72+73+74+75+76+77+78+79+80+81+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+129+130+131+132+133+134+135+136+137+138+139+140+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+212+213+214+215+216+217+218+219+220+221) or (intraprot_topo02_seq07_FP_C6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_4_seed_000-aligned and resi 75+76+77+78+79+80+81+82+83+84+85+86+87+88+53+54+55+56+57+58+59+60+61+62+63+64+65+66+67+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24+25+26+27+28+29+30+31+32+33+34+35+102+103+104+105+106+107+108+109+110+111+112+113+114+115+116+117+118+119+120+121+122+123+124+125+126+127+128+129+130+131+132+133+134+135+136+137+138+139+140+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194) or (intraprot_topo03_seq01_N6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_3_seed_000-aligned and resi 27+28+29+30+31+32+33+34+35+36+37+38+39+40+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+60+61+62+63+64+65+66+67+68+69+70+71+72+73+74+75+76+77+78+79+80+81+82+83+84+85+86+130+131+132+133+134+135+136+137+138+139+140+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+212+213+214+215+216+217+218+219+220+221+222) or (intraprot_topo03_seq02_N6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_4_seed_000-aligned and resi 27+28+29+30+31+32+33+34+35+36+37+38+39+40+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+89+90+91+92+93+94+95+96+97+98+99+100+101+102+103+104+105+106+107+108+109+110+111+112+113+114+115+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+212+213+214+215+216+217+218+219+220+221+222+223+224+225+226+227+228+229+230+231+232+233+234+235+236+237+238+239+240+241+242+243+244+245+246+247+248+249+250+251+252+253+254+255+256+257+258+259) or (intraprot_topo03_seq03_N6H_pVax_unrelaxed_rank_001_alphafold2_multimer_v3_model_4_seed_000-aligned and resi 27+28+29+30+31+32+33+34+35+36+37+38+39+40+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+70+71+72+73+74+75+76+77+78+79+80+81+82+83+84+85+86+87+88+89+90+91+92+93+94+95+96+141+142+143+144+145+146+147+148+149+150+151+152+153+154+155+156+157+158+159+160+161+162+163+164+165+166+167+168+169+170+171+172+173+174+175+176+177+178+179+180+181+182+183+184+185+186+187+188+189+190+191+192+193+194+195+196+197+198+199+200+201+202+203+204+205+206+207+208+209+210+211+212+213+214+215+216+217+218+219+220+221+222+223+224+225+226+227+228+229+230+231+232+233)

# H3RBS /home/cagostino/work/workspace/H3RBS/leads3/baseModels/movie
substrings=("CY[A-Z]Y" "TQNGTSSAC" "WLTHLNY" "HHPGTDKDQIFL" "IPSRI")
# # sele (H3head_topo01_648_design_00002_0001-aligned and resi 122+123+124+125+25+26+27+28+29+30+31+32+33+143+144+145+146+147+148+149+80+81+82+83+84+85+86+87+88+89+90+91+53+54+55+56+57) or (H3head_topo02_149_design_00001_0001-aligned and resi 83+84+85+86+139+140+141+142+143+144+145+146+147+11+12+13+14+15+16+17+46+47+48+49+50+51+52+53+54+55+56+57+115+116+117+118+119) or (H3head_topo07_723_design_00001_0001-aligned and resi 22+23+24+25+144+145+146+147+148+149+150+151+152+77+78+79+80+81+82+83+110+111+112+113+114+115+116+117+118+119+120+121+49+50+51+52+53) or (H3head_topo07_723_design_00004_0001-aligned and resi 22+23+24+25+144+145+146+147+148+149+150+151+152+77+78+79+80+81+82+83+110+111+112+113+114+115+116+117+118+119+120+121+49+50+51+52+53) or (H3head_topo09_410_design_00005_0001-aligned and resi 27+28+29+30+130+131+132+133+134+135+136+137+138+117+118+119+120+121+122+123+78+79+80+81+82+83+84+85+86+87+88+89+46+47+48+49+50) or (H3head_topo09_482_design_00001_0001-aligned and resi 15+16+17+18+139+140+141+142+143+144+145+146+147+116+117+118+119+120+121+122+77+78+79+80+81+82+83+84+85+86+87+88+46+47+48+49+50) or (H3head_topo10_596_design_00005_0001-aligned and resi 25+26+27+28+73+74+75+76+77+78+79+80+81+102+103+104+105+106+107+108+136+137+138+139+140+141+142+143+144+145+146+147+44+45+46+47+48) or (H3head_topo11_130_design_00001_0001-aligned and resi 12+13+14+15+76+77+78+79+80+81+82+83+84+156+157+158+159+160+161+162+115+116+117+118+119+120+121+122+123+124+125+126+41+42+43+44+45) or (H3head_topo11_506_design_00001_0001-aligned and resi 16+17+18+19+75+76+77+78+79+80+81+82+83+140+141+142+143+144+145+146+110+111+112+113+114+115+116+117+118+119+120+121+47+48+49+50+51) or (H3head_topo16_51_design_00004_0001-aligned and resi 27+28+29+30+77+78+79+80+81+82+83+84+85+52+53+54+55+56+57+58+148+149+150+151+152+153+154+155+156+157+158+159+114+115+116+117+118) or (H3head_topo17_118_design_00002_0001-aligned and resi 11+12+13+14+68+69+70+71+72+73+74+75+76+130+131+132+133+134+135+136+33+34+35+36+37+38+39+40+41+42+43+44+103+104+105+106+107) or (H3head_topo18_831_design_00001_0001-aligned and resi 52+53+54+55+111+112+113+114+115+116+117+118+119+129+130+131+132+133+134+135+13+14+15+16+17+18+19+20+21+22+23+24+78+79+80+81+82) or (H3head_topo23_241_design_00001_0001-aligned and resi 23+24+25+26+119+120+121+122+123+124+125+126+127+144+145+146+147+148+149+150+77+78+79+80+81+82+83+84+85+86+87+88+51+52+53+54+55) or (H3head_topo23_241_design_00003_0001-aligned and resi 23+24+25+26+119+120+121+122+123+124+125+126+127+144+145+146+147+148+149+150+77+78+79+80+81+82+83+84+85+86+87+88+51+52+53+54+55) or (H3head_topo23_376_design_00002_0001-aligned and resi 9+10+11+12+105+106+107+108+109+110+111+112+113+130+131+132+133+134+135+136+66+67+68+69+70+71+72+73+74+75+76+77+41+42+43+44+45)

pymol_statement="sele"
mkdir color

for pdb in *pdb; do

    # set all B factors to zero
    awk '{printf("%s%6s%s\n", substr($0, 1, 60), "  0.00", substr($0, 67))}' $pdb > "${pdb::-4}_colored.pdb"

    # Initialize an empty array to store positions
    position_strings=()
    selection=()

    seq=$(cat $pdb | awk '/^ATOM/ && $3 == "CA" && $5 == "A" {print $4}' | tr '\n' ' ' | sed -e 's/ALA/A/g' -e 's/CYS/C/g' -e 's/ASP/D/g' -e 's/GLU/E/g' -e 's/PHE/F/g' -e 's/GLY/G/g' -e 's/HIS/H/g' -e 's/ILE/I/g' -e 's/LYS/K/g' -e 's/LEU/L/g' -e 's/MET/M/g' -e 's/ASN/N/g' -e 's/PRO/P/g' -e 's/GLN/Q/g' -e 's/ARG/R/g' -e 's/SER/S/g' -e 's/THR/T/g' -e 's/VAL/V/g' -e 's/TRP/W/g' -e 's/TYR/Y/g' -e 's/ //g')

    index=0
    # Loop through the substrings
    for substring in "${substrings[@]}"; do
        # Find positions of the substring
        positions=($(echo "$seq" | grep -bo "$substring" | cut -d':' -f1))

        # Check the length of positions array
        if [ "${#positions[@]}" -gt 1 ]; then
            echo "Warning: Multiple positions found for substring '$substring'"

        elif [ "${#positions[@]}" -lt 1 ]; then
            echo "Warning: No positions found for substring '$substring'"

        else
            # Get the single position
            position="${positions[0]}"

            # Count the number of '[' characters in the substring
            bracket_count=$(echo "$substring" | tr -cd '[' | wc -c)

            # Calculate the ending position by subtracting 4 times the bracket count
            end_position=$((position + ${#substring} - 4 * bracket_count))

            # Initialize an empty array to store positions
            position_list=()
            # Create an array of positions from start to end
            for ((i = position + 1; i <= end_position; i++)); do
                position_list+=("$i")
                # Echo the letter at that position
                letter=$(echo "$seq" | cut -c "$i")
                # echo "Position $i: $letter"

                # set b factor to 1.00
                awk -i inplace -v res="$i" 'substr($0, 1, 4) == "ATOM" && substr($0, 23, 4) == sprintf("%4s", res) {$0 = substr($0, 1, 60) "  1.00" substr($0, 67); print} substr($0, 1, 4) != "ATOM" || substr($0, 23, 4) != sprintf("%4s", res) {print}' "${pdb::-4}_colored.pdb"
            done
            position_string=$(IFS=+; echo "${position_list[*]}")
            position_strings+=("$position_string")
        fi
        # Increment the counter
        ((index++))
    done

    # # alignMolecule strings
    # echo "position strings"
    # for p in "${position_strings[@]}"
    # do
    #     echo $p
    # done

    for string in "${position_strings[@]}"; do
        selection+="+$string"
    done

    # echo $selection
    pymol_statement+=" (${pdb::-4} and resi ${selection:1}) or"
done
mv *colored.pdb color
echo ${pymol_statement::-3}